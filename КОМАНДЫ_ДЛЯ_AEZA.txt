════════════════════════════════════════════════════════════
🇷🇺 КОМАНДЫ ДЛЯ ПОДКЛЮЧЕНИЯ АГЕНТА НА VPS AEZA
════════════════════════════════════════════════════════════

📝 Данные VPS Aeza:
IP: 138.124.14.179
User: root
Password: pd91BP0G5b60

════════════════════════════════════════════════════════════
ШАГ 1: Регистрация агента (на вашем компьютере)
════════════════════════════════════════════════════════════

curl -X POST http://localhost:8000/api/agents/register \
  -H "Content-Type: application/json" \
  -H "X-Registration-Token: hackathon-aeza-2025" \
  -d '{
    "name": "Agent-Moscow-Aeza",
    "location": "Russia, Moscow",
    "metadata": {"provider": "Aeza", "ip": "138.124.14.179"}
  }'

⚠️ СОХРАНИТЕ agent_id и api_token из ответа!

════════════════════════════════════════════════════════════
ШАГ 2: Подключиться к VPS
════════════════════════════════════════════════════════════

ssh root@138.124.14.179

Пароль: pd91BP0G5b60

════════════════════════════════════════════════════════════
ШАГ 3: Установить Docker (на VPS)
════════════════════════════════════════════════════════════

curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh
curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose
docker --version

════════════════════════════════════════════════════════════
ШАГ 4: Создать директорию (на VPS)
════════════════════════════════════════════════════════════

mkdir -p /opt/hostchecker-agent
cd /opt/hostchecker-agent

════════════════════════════════════════════════════════════
ШАГ 5: Загрузить файлы (с вашего компьютера, НОВЫЙ ТЕРМИНАЛ)
════════════════════════════════════════════════════════════

cd /Users/slava/Hack2025/Reaf-Team_Hackathon-Autumn
scp agent_production.py root@138.124.14.179:/opt/hostchecker-agent/
scp requirements.txt root@138.124.14.179:/opt/hostchecker-agent/
scp Dockerfile.agent root@138.124.14.179:/opt/hostchecker-agent/
scp docker-compose.agent.yml root@138.124.14.179:/opt/hostchecker-agent/

Пароль (4 раза): pd91BP0G5b60

════════════════════════════════════════════════════════════
ШАГ 6: Создать конфигурацию (на VPS)
════════════════════════════════════════════════════════════

cd /opt/hostchecker-agent
nano .env.agent

Вставьте (замените YOUR_AGENT_ID и YOUR_API_TOKEN):

MAIN_SERVER_URL=http://localhost:8000
AGENT_COUNTRY=Russia
AGENT_NAME=Agent-Moscow-Aeza
AGENT_UIID=YOUR_AGENT_ID
AGENT_API_TOKEN=YOUR_API_TOKEN
POLL_INTERVAL=5
MAX_CONCURRENT_TASKS=10
PORT=8001

⚠️ Если backend на вашем компьютере, вместо localhost укажите IP компьютера!

Узнать IP: ifconfig | grep "inet " | grep -v 127.0.0.1

Сохранить: Ctrl+X → Y → Enter

════════════════════════════════════════════════════════════
ШАГ 7: Запустить агента (на VPS)
════════════════════════════════════════════════════════════

cd /opt/hostchecker-agent
docker-compose -f docker-compose.agent.yml build
docker-compose -f docker-compose.agent.yml up -d

════════════════════════════════════════════════════════════
ШАГ 8: Проверить (на VPS)
════════════════════════════════════════════════════════════

# Health check
curl http://localhost:8001/

# Логи
docker-compose -f docker-compose.agent.yml logs -f

(Ctrl+C для выхода из логов)

════════════════════════════════════════════════════════════
ШАГ 9: Проверить в UI (в браузере)
════════════════════════════════════════════════════════════

Откройте: http://localhost:3000

Перейдите в раздел "Агенты"

Должен появиться "Agent-Moscow-Aeza" со статусом 🟢 online

════════════════════════════════════════════════════════════
✅ ГОТОВО!
════════════════════════════════════════════════════════════

Теперь создайте проверку для edu.donstu.ru:
1. Dashboard → введите "edu.donstu.ru"
2. Выберите: HTTP, Ping, DNS
3. Нажмите "Создать проверку"
4. Смотрите результаты!

════════════════════════════════════════════════════════════
🔧 КОМАНДЫ ДЛЯ УПРАВЛЕНИЯ АГЕНТОМ
════════════════════════════════════════════════════════════

# Статус
docker-compose -f /opt/hostchecker-agent/docker-compose.agent.yml ps

# Логи
docker-compose -f /opt/hostchecker-agent/docker-compose.agent.yml logs -f

# Перезапуск
docker-compose -f /opt/hostchecker-agent/docker-compose.agent.yml restart

# Остановка
docker-compose -f /opt/hostchecker-agent/docker-compose.agent.yml stop

# Удаление
docker-compose -f /opt/hostchecker-agent/docker-compose.agent.yml down

════════════════════════════════════════════════════════════

